---
stepsCompleted: [1, 2, 3, 4, 5, 6, 7]
inputDocuments:
  - _bmad-output/planning-artifacts/product-brief-bmad-test2-2026-02-11.md
  - _bmad-output/planning-artifacts/prd.md
  - _bmad-output/planning-artifacts/prd-validation-report.md
  - _bmad-output/planning-artifacts/ux-design-specification.md
  - _bmad-output/project-context.md
  - _bmad-output/brainstorming/brainstorming-session-2026-02-10.md
  - docs/TECH_SPEC.md
  - docs/TECH_SPEC_ARCHITECTURE.md
  - docs/TECH_SPEC_DATABASE.md
  - docs/TECH_SPEC_BUN.md
  - docs/TECH_SPEC_TYPES.md
  - docs/TECH_SPEC_API.md
  - docs/TECH_SPEC_PWA.md
  - docs/TECH_SPEC_BDD.md
  - docs/TECH_SPEC_LOGGING.md
  - docs/TECH_SPEC_PERFORMANCE.md
  - docs/TECH_SPEC_TESTING.md
workflowType: 'architecture'
project_name: 'bmad-test2'
user_name: 'boss'
date: '2026-02-12'
---

# Architecture Decision Document

_This document builds collaboratively through step-by-step discovery. Sections are appended as we work through each architectural decision together._

---

## Project Context Analysis

### Requirements Overview

**Functional Requirements:**
Family Reward åŒ…å«60ä¸ªåŠŸèƒ½éœ€æ±‚ï¼ˆFR1-FR60ï¼‰ï¼Œæ¶µç›–ï¼š
- **ç”¨æˆ·ç®¡ç†ï¼ˆ7ä¸ªFRï¼‰ï¼š** æ‰‹æœºå·/PINç æ³¨å†Œã€è§’è‰²ç®¡ç†ï¼ˆParent/Child/Adminï¼‰ã€å®¶åº­è®¾ç½®
- **ä»»åŠ¡ç®¡ç†ï¼ˆ12ä¸ªFRï¼‰ï¼š** è®¡åˆ’ä»»åŠ¡æ¨¡æ¿åˆ›å»ºã€æ—¥æœŸç­–ç•¥å¼•æ“ã€ä»»åŠ¡å®ä¾‹ç”Ÿæˆã€å®¡æ‰¹æµç¨‹
- **ç§¯åˆ†ç³»ç»Ÿï¼ˆ9ä¸ªFRï¼‰ï¼š** çº¿æ€§å åŠ ä¸å›é€€ã€å®¡æ‰¹åç»“ç®—ã€å†å²è®°å½•ã€ä½™é¢ç®¡ç†
- **æ„¿æœ›ç³»ç»Ÿï¼ˆ9ä¸ªFRï¼‰ï¼š** åˆ›å»ºã€å®¡æ ¸ã€å…‘æ¢æµç¨‹ã€è¿›åº¦æ¡å®æ—¶è®¡ç®—
- **Comboæ¿€åŠ±ï¼ˆ6ä¸ªFRï¼‰ï¼š** è¿ç»­å®Œæˆè¿½è¸ªã€çº¿æ€§/é˜¶æ¢¯å¥–åŠ±ã€å®½é™æœºåˆ¶
- **æ¸¸æˆåŒ–ï¼ˆ5ä¸ªFRï¼‰ï¼š** ç­¾åˆ°ã€å¾½ç« ç³»ç»Ÿã€ç­‰çº§ç³»ç»Ÿ
- **ç®¡ç†å‘˜åŠŸèƒ½ï¼ˆ6ä¸ªFRï¼‰ï¼š** æ¨¡æ¿ç®¡ç†ã€å®¶åº­å®¡æ ¸ã€å›¾åºŠç®¡ç†ã€å…¨å±€ç»Ÿè®¡
- **é€šçŸ¥ä¸è®¾ç½®ï¼ˆ6ä¸ªFRï¼‰ï¼š** ä»»åŠ¡æé†’ã€å®¡æ‰¹é€šçŸ¥ã€æ„¿æœ›å®¡æ ¸é€šçŸ¥ã€Comboä¸­æ–­è­¦æŠ¥ã€é›†ä¸­é€šçŸ¥ä¸­å¿ƒã€å®¶åº­è§„åˆ™é…ç½®

**Non-Functional Requirements:**
- **æ€§èƒ½ï¼š** å„¿ç«¥ç«¯é¡µé¢åŠ è½½ < 2ç§’ã€å®¶é•¿ç«¯ç»Ÿè®¡é¡µé¢ < 3ç§’ã€APIå“åº” < 500msï¼ˆP95ï¼‰ã€å®æ—¶åŒæ­¥å»¶è¿Ÿ < 3ç§’
- **å®‰å…¨ï¼š** HTTPS/TLS 1.3ã€RBACã€ä¼šè¯ç®¡ç†ï¼ˆ36å°æ—¶ï¼‰ã€æ“ä½œæ—¥å¿—å®¡è®¡
- **åˆè§„æ€§ï¼š** COPPAï¼ˆ13å²ä»¥ä¸‹ï¼‰ã€GDPRï¼ˆ16å²ä»¥ä¸‹ï¼‰ã€ä¸­å›½å„¿ç«¥ä¿æŠ¤ï¼ˆ14å²ä»¥ä¸‹ï¼‰ã€æ•°æ®ç•™å­˜3å¹´ã€è½¯åˆ é™¤7å¤©å¯æ¢å¤
- **å¯æ‰©å±•æ€§ï¼š** æ”¯æŒ5000 DAUã€é¢„ç•™æ°´å¹³æ‰©å±•èƒ½åŠ›

**Scale & Complexity:**
- **Primary domain:** å…¨æ ˆWebåº”ç”¨ï¼ˆFull-Stack Web Appï¼‰- PWA + å°ç¨‹åºæ”¯æŒ
- **Complexity level:** ä¸­ç­‰-åé«˜

---

### Technical Constraints & Dependencies

**ç¡®å®šçš„æŠ€æœ¯æ ˆï¼š**
- **è¿è¡Œæ—¶ï¼š** Bun 1.3.x+ï¼ˆç¦æ­¢Node.jså…¼å®¹å±‚ï¼‰
- **å‰ç«¯æ¡†æ¶ï¼š** Next.js 16.1.6 + React 19.2.3
- **æ•°æ®åº“ï¼š** bun:sqlite + Drizzle ORM 0.45.1+ï¼ˆç¦æ­¢åŸç”ŸSQLï¼‰
- **è®¤è¯ï¼š** Better-Auth 1.4.18+ï¼ˆphoneæ’ä»¶ + PINç ï¼‰
- **UIç³»ç»Ÿï¼š** Tailwind CSS 4 + Shadcn UI 3.7.0+
- **æµ‹è¯•ï¼š** Bun Test + Playwright 1.58.0ï¼ˆBDDé£æ ¼ï¼‰
- **ç±»å‹ç³»ç»Ÿï¼š** TypeScript 5ï¼ˆstrictæ¨¡å¼ï¼Œç¦æ­¢anyï¼‰

**å…³é”®å®æ–½è§„åˆ™ï¼ˆ20æ¡ï¼‰ï¼š**
- å¼ºåˆ¶ä½¿ç”¨ Drizzle ORMï¼ˆlib/db/queries/æŒ‰è¡¨åˆ†æ–‡ä»¶ï¼‰
- BDDå¼€å‘ï¼ˆGiven-When-Thenæ ¼å¼ï¼Œå…ˆå†™æµ‹è¯•åå®ç°ï¼‰
- ç¦æ­¢ä½¿ç”¨Node.jså·¥å…·ï¼ˆå¿…é¡»ç”¨Bunå†…ç½®ï¼šBun.file(), Bun.password.hash(), Bun.envï¼‰
- ç±»å‹å®‰å…¨ï¼ˆunknown + ç±»å‹å®ˆå«ï¼Œç¦æ­¢@ts-ignoreï¼‰
- æ–‡ä»¶é•¿åº¦é™åˆ¶ï¼ˆæ‰€æœ‰æ–‡ä»¶ â‰¤ 800è¡Œï¼‰

---

### Cross-Cutting Concerns Identified

1. **å®æ—¶æ•°æ®ä¸€è‡´æ€§** - å‰ç«¯çŠ¶æ€ç®¡ç†ã€APIè®¾è®¡ã€åŒæ­¥ç­–ç•¥
2. **å¤šè®¾å¤‡åŒæ­¥ä¸ç¦»çº¿é˜Ÿåˆ—** - Service Workerã€IndexedDBã€åç«¯åŒæ­¥API
3. **å„¿ç«¥éšç§åˆè§„** - æ•°æ®åº“è®¾è®¡ã€è®¤è¯æµç¨‹ã€æ•°æ®ç•™å­˜ç­–ç•¥
4. **åŒç«¯ä½“éªŒå·®å¼‚åŒ–** - å“åº”å¼è®¾è®¡ã€ç»„ä»¶æŠ½è±¡ã€ä¸»é¢˜åˆ‡æ¢
5. **ç§¯åˆ†ç»“ç®—ä¸Comboè®¡ç®—** - æ•°æ®åº“äº‹åŠ¡ã€APIåŸå­æ€§ã€å‰ç«¯çŠ¶æ€ç®¡ç†

---

## Architecture Decision Records

### å†³ç­–ç‚¹ 1ï¼šæ•°æ®åº“æ¶æ„

**é€‰é¡¹åˆ†æï¼š**
- SQLite (bun:sqlite) - é›¶é…ç½®ï¼Œæ˜“äºè¿ç§»ï¼Œé€‚åˆ MVP
- PostgreSQL - é«˜å¹¶å‘æ€§èƒ½ï¼Œæ°´å¹³æ‰©å±•èƒ½åŠ›å¼º

**å†³ç­–ï¼šé€‰æ‹© SQLite (bun:sqlite)**
**ç†ç”±ï¼š**
1. MVP èŒƒå›´åŒ¹é…ï¼šPRD æ˜ç¡®æ”¯æŒ 5000 DAUï¼ŒSQLite å®Œå…¨æ»¡è¶³æ­¤éœ€æ±‚
2. å¼€å‘æ•ˆç‡ä¼˜å…ˆï¼šproject-context.md å¼ºè°ƒ Bun åŸç”Ÿå·¥å…·ï¼Œé›¶é…ç½®æ˜¾è‘—åŠ å¿«å¼€å‘é€Ÿåº¦
3. æ¼”è¿›è·¯å¾„æ¸…æ™°ï¼šæŠ€æœ¯è§„èŒƒé¢„ç•™ PostgreSQL è¿ç§»è·¯å¾„ï¼ˆäºŒæœŸç”¨æˆ·å¢é•¿åå‡çº§ï¼‰

---

### å†³ç­–ç‚¹ 2ï¼šå®æ—¶é€šä¿¡ç­–ç•¥

**é€‰é¡¹åˆ†æï¼š**
- è½®è¯¢ï¼ˆ2-3ç§’ï¼‰- å®ç°ç®€å•ï¼Œæ»¡è¶³ < 3ç§’è¦æ±‚
- SSE - å•å‘é«˜æ•ˆï¼ŒHTTP æ ‡å‡†åè®®
- WebSocket - å…¨åŒå·¥å®æ—¶ï¼Œä½å»¶è¿Ÿ

**å†³ç­–ï¼šé€‰æ‹©æ··åˆæ–¹æ¡ˆ - åˆæœŸè½®è¯¢ï¼Œé¢„ç•™ SSE/WebSocket æ¥å£**

**ç†ç”±ï¼š**
1. MVP å¿«é€Ÿå¯åŠ¨ï¼šè½®è¯¢å®ç°ç®€å•ï¼Œ2-3ç§’å»¶è¿Ÿæ»¡è¶³ PRD è¦æ±‚
2. æŠ€æœ¯å€ºåŠ¡å¯æ§ï¼šé¢„ç•™å‡çº§è·¯å¾„ï¼Œä¸å½±å“ç”¨æˆ·å¢é•¿åæ‰©å±•
3. å¼€å‘æ•ˆç‡ï¼šé¿å…è¿‡åº¦å·¥ç¨‹åŒ–ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½

---

### å†³ç­–ç‚¹ 3ï¼šçŠ¶æ€ç®¡ç†

**é€‰é¡¹åˆ†æï¼š**
- Zustand - è½»é‡çº§ã€ç®€å•æ˜“ç”¨
- Redux Toolkit - å®Œæ•´çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ
- Jotai - ç±»å‹ä¼˜å…ˆçš„çŠ¶æ€ç®¡ç†

**å†³ç­–ï¼šé€‰æ‹© Zustand**
**ç†ç”±ï¼š**
1. æŠ€æœ¯æ ˆä¸€è‡´æ€§ï¼šé¡¹ç›®ä½¿ç”¨ Bun + Reactï¼ŒZustand æ€§èƒ½ä¼˜å¼‚
2. å¼€å‘æ•ˆç‡ä¼˜å…ˆï¼šç®€å• API å‡å°‘æ ·æ¿ä»£ç ï¼ŒåŠ å¿« MVP å¼€å‘
3. å¤æ‚åº¦åŒ¹é…ï¼šå®æ—¶åŒæ­¥ + ç¦»çº¿é˜Ÿåˆ—ä¸éœ€è¦å¤æ‚çŠ¶æ€ç®¡ç†

---

### å†³ç­–ç‚¹ 4ï¼šå›¾è¡¨åº“

**é€‰é¡¹åˆ†æï¼š**
- Recharts - React åŸç”Ÿã€TypeScript ä¼˜ç§€æ”¯æŒ
- Chart.js - è½»é‡çº§ã€æ€§èƒ½ä¼˜ç§€
- Victory - React ç»„ä»¶åŒ–å›¾è¡¨

**å†³ç­–ï¼šé€‰æ‹© Recharts**
**ç†ç”±ï¼š**
1. æŠ€æœ¯æ ˆä¸€è‡´æ€§ï¼šReact åŸç”Ÿï¼ŒTypeScript ä¼˜ç§€æ”¯æŒ
2. è®¾è®¡ç³»ç»Ÿå…¼å®¹ï¼šä¸ Tailwind + Shadcn UI æ— ç¼é›†æˆ
3. åŠŸèƒ½éœ€æ±‚åŒ¹é…ï¼šè¶³å¤Ÿå®ç° UX Design ä¸­çš„æˆé•¿æ›²çº¿å’Œä»»åŠ¡å®Œæˆç‡å›¾è¡¨

---

### å†³ç­–ç‚¹ 5ï¼šåŠ¨ç”»ç³»ç»Ÿ

**é€‰é¡¹åˆ†æï¼š**
- CSS åŠ¨ç”» - é›¶ä¾èµ–ã€æ€§èƒ½ä¼˜ç§€
- Framer Motion - å£°æ˜å¼ APIã€ç‰©ç†æ¨¡æ‹Ÿ
- React Spring - åŸºäºç‰©ç†çš„åŠ¨ç”»

**å†³ç­–ï¼šé€‰æ‹© CSS åŠ¨ç”»ä¼˜å…ˆ + Framer Motion è¡¥å……**

**ç†ç”±ï¼š**
1. æ€§èƒ½ä¼˜å…ˆï¼šMVP èŒƒå›´ä½¿ç”¨ CSS åŠ¨ç”»è¶³å¤Ÿï¼Œé›¶ä¾èµ–
2. å¼€å‘æ•ˆç‡ï¼šTailwind CSS å†…ç½®åŠ¨ç”»æ”¯æŒï¼Œå¿«é€Ÿå®ç°
3. æŒ‰éœ€å¼•å…¥ï¼šFramer Motion ä»…ç”¨äºå¤æ‚æ¸¸æˆåŒ–å…ƒç´ ï¼ˆå¾½ç« åº†ç¥ï¼‰

---

### å†³ç­–ç‚¹ 6ï¼šç¼“å­˜ç­–ç•¥

**é€‰é¡¹åˆ†æï¼š**
- æ— ç¼“å­˜ - é›¶å¤æ‚åº¦ã€æ•°æ®ä¸€è‡´æ€§å¥½
- Redis - é«˜æ€§èƒ½ã€æ”¯æŒå¤æ‚æ•°æ®ç»“æ„

**å†³ç­–ï¼šé€‰æ‹© MVP æ— ç¼“å­˜ï¼Œé¢„ç•™ Redis æ¥å£**

**ç†ç”±ï¼š**
1. MVP èŒƒå›´åŒ¹é…ï¼š5000 DAUï¼ŒSQLite æ€§èƒ½è¶³å¤Ÿï¼Œæ— éœ€é¢å¤–ç¼“å­˜å±‚
2. å¼€å‘æ•ˆç‡ä¼˜å…ˆï¼šå‡å°‘è¿ç»´å¤æ‚åº¦ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½
3. æ¼”è¿›è·¯å¾„æ¸…æ™°ï¼šTech Spec é¢„ç•™ Redis æ¥å£ï¼Œç”¨æˆ·å¢é•¿åå‡çº§

---

## Architecture Decision Records (ADR) - æ·±åº¦åˆ†æ

### ADR-1: å®æ—¶é€šä¿¡æ¶æ„é€‰æ‹©

**æ¶æ„å¸ˆï¼ˆæ€§èƒ½ä¸“å®¶ï¼‰ææ¡ˆï¼š**
- **é€‰æ‹©ï¼š** WebSocketï¼ˆæŒä¹…è¿æ¥ï¼‰
- **ç†ç”±ï¼š** æœ€ä½å»¶è¿Ÿï¼ˆ<100msï¼‰ã€å®æ—¶æ¨é€
- **æƒè¡¡ï¼š** è¿æ¥çŠ¶æ€ç®¡ç†å¤æ‚ã€æœåŠ¡å™¨èµ„æºæ¶ˆè€—æ›´é«˜

**ADR-1 å†³ç­–ï¼š**
- **é€‰æ‹©ï¼š** è½®è¯¢æœºåˆ¶ï¼ˆ2-3ç§’é—´éš”ï¼‰â†’ SSEå‡çº§è·¯å¾„
- **ç†ç”±ï¼š**
  1. å®ç°ç®€å•ï¼ŒMVPå¿«é€Ÿäº¤ä»˜
  2. æ»¡è¶³PRDè¦æ±‚çš„3ç§’å»¶è¿Ÿ
  3. ä»£ç åº“å·²æ˜ç¡®é¢„ç•™SSEå‡çº§è·¯å¾„
- **è®°å½•äººï¼š** Winston
- **æ—¥æœŸï¼š** 2026-02-12
- **çŠ¶æ€ï¼š** å·²é‡‡çº³
- **æ›¿ä»£æ–¹æ¡ˆï¼š** WebSocketã€SSEï¼ˆç›´æ¥ä½¿ç”¨ï¼‰
- **åæœï¼š** è½®è¯¢å¢åŠ æœåŠ¡å™¨è´Ÿè½½ï¼Œä½†åœ¨5000 DAUèŒƒå›´å†…å¯æ¥å—

---

### ADR-2: æ•°æ®åº“é€‰æ‹©ä¸æ¶æ„æ¼”è¿›

**æ¶æ„å¸ˆï¼ˆå®‰å…¨ä¸“å®¶ï¼‰ææ¡ˆï¼š**
- **é€‰æ‹©ï¼š** PostgreSQLï¼ˆä»ç¬¬ä¸€å¤©å¼€å§‹ï¼‰
- **ç†ç”±ï¼š** ACIDäº‹åŠ¡å®Œå–„ã€å¹¶å‘å¤„ç†èƒ½åŠ›å¼º
- **æƒè¡¡ï¼š** éƒ¨ç½²å¤æ‚åº¦é«˜ã€åˆæœŸå¼€å‘è¾ƒæ…¢

**ADR-2 å†³ç­–ï¼š**
- **é€‰æ‹©ï¼š** SQLite + Drizzle ORMï¼ˆåˆæœŸï¼‰â†’ PostgreSQLå‡çº§è·¯å¾„ï¼ˆäºŒæœŸï¼‰
- **ç†ç”±ï¼š**
  1. é¡¹ç›®ä¸Šä¸‹æ–‡å·²å¼ºåˆ¶SQLiteé€‰æ‹©
  2. Drizzle ORMæŠ½è±¡æ•°æ®åº“å±‚ï¼Œè¿ç§»æˆæœ¬ä½
  3. PRDæ˜ç¡®é¢„ç•™PostgreSQLå‡çº§è·¯å¾„
  4. MVPéªŒè¯æ•°æ®æ¨¡å¼åå†è¿ç§»
- **è®°å½•äººï¼š** Winston
- **æ—¥æœŸï¼š** 2026-02-12
- **çŠ¶æ€ï¼š** å·²é‡‡çº³
- **æ›¿ä»£æ–¹æ¡ˆï¼š** PostgreSQLï¼ˆç›´æ¥ä½¿ç”¨ï¼‰
- **åæœï¼š** å¹¶å‘å†™å…¥å—é™ï¼Œä½†å¯¹MVPè§„æ¨¡å¯æ¥å—

---

### ADR-3: è®¤è¯ä¸ä¼šè¯ç®¡ç†æ¶æ„

**æ¶æ„å¸ˆï¼ˆå®‰å…¨ä¸“å®¶ï¼‰ææ¡ˆï¼š**
- **é€‰æ‹©ï¼š** OAuth 2.0 + JWTä»¤ç‰Œ
- **ç†ç”±ï¼š** è¡Œä¸šæ ‡å‡†ã€ä»¤ç‰Œå¯æ’¤é”€
- **æƒè¡¡ï¼š** å®ç°å¤æ‚ã€éœ€è¦ä»¤ç‰Œåˆ·æ–°é€»è¾‘

**ADR-3 å†³ç­–ï¼š**
- **é€‰æ‹©ï¼š** Better-Auth 1.4.18+ + phoneæ’ä»¶ + PINç ç™»å½•
- **ç†ç”±ï¼š**
  1. é¡¹ç›®ä¸Šä¸‹æ–‡å¼ºåˆ¶é€‰æ‹©
  2. Better-Authå¤„ç†å®‰å…¨æœ€ä½³å®è·µ
  3. æ‰‹æœºOTP + PINç æ»¡è¶³å¤šè§’è‰²éœ€æ±‚
  4. 36å°æ—¶ä¼šè¯æ»šåŠ¨åˆ·æ–°ç¬¦åˆPRDè¦æ±‚
- **è®°å½•äººï¼š** Winston
- **æ—¥æœŸï¼š** 2026-02-12
- **çŠ¶æ€ï¼š** å·²é‡‡çº³
- **æ›¿ä»£æ–¹æ¡ˆï¼š** OAuth 2.0 + JWT
- **åæœï¼š** å„¿ç«¥ç«¯éœ€è¦æ‰‹åŠ¨è¾“å…¥PINç ï¼›ä¸æ”¯æŒç”Ÿç‰©è¯†åˆ«ç™»å½•

---

### ADR-4: ç¦»çº¿é˜Ÿåˆ—ä¸å†²çªè§£å†³æ¶æ„

**æ¶æ„å¸ˆï¼ˆæ€§èƒ½ä¸“å®¶ï¼‰ææ¡ˆï¼š**
- **é€‰æ‹©ï¼š** Service Worker + Cache API
- **ç†ç”±ï¼š** æµè§ˆå™¨åŸç”Ÿæ”¯æŒã€PWAæ ‡å‡†
- **æƒè¡¡ï¼š** Cache APIä¸é€‚åˆå¤æ‚æ“ä½œé˜Ÿåˆ—

**æ¶æ„å¸ˆï¼ˆå®‰å…¨ä¸“å®¶ï¼‰å»ºè®®ï¼š**
- **é€‰æ‹©ï¼š** IndexedDB + æ—¶é—´æˆ³å†²çªè§£å†³
- **ç†ç”±ï¼š**
  - IndexedDBæ”¯æŒå¤æ‚æ•°æ®ç»“æ„
  - æ—¶é—´æˆ³æä¾›å†²çªè§£å†³å®¡è®¡è·Ÿè¸ª
  - æ»¡è¶³PRDè¦æ±‚çš„"ä¹è§‚é”æˆ–æ—¶é—´æˆ³ç­–ç•¥"
- **æƒè¡¡ï¼š** éœ€è¦æ‰‹åŠ¨é˜Ÿåˆ—ç®¡ç†é€»è¾‘

**ADR-4 å†³ç­–ï¼š**
- **é€‰æ‹©ï¼š** IndexedDB + Background Sync API + æ—¶é—´æˆ³å†²çªè§£å†³
- **ç†ç”±ï¼š**
  1. æ»¡è¶³PRDç¦»çº¿èƒ½åŠ›è¦æ±‚
  2. ä¹è§‚UIæä¾›å³æ—¶åé¦ˆ
  3. æ—¶é—´æˆ³ç­–ç•¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
  4. ç”¨æˆ·é€‰æ‹©é¿å…æ•°æ®ä¸¢å¤±
- **è®°å½•äººï¼š** Winston
- **æ—¥æœŸï¼š** 2026-02-12
- **çŠ¶æ€ï¼š** å·²é‡‡çº³
- **æ›¿ä»£æ–¹æ¡ˆï¼š** Service Worker + Cache API
- **åæœï¼š** éœ€è¦å®ç°é˜Ÿåˆ—ç®¡ç†é€»è¾‘ï¼›ç”¨æˆ·å¯èƒ½éœ€è¦æ‰‹åŠ¨è§£å†³å†²çª

---

### ADR-5: æ•°æ®åº“æŸ¥è¯¢å±‚æ¶æ„

**æ¶æ„å¸ˆï¼ˆå¯æ‰©å±•æ€§ä¸“å®¶ï¼‰ææ¡ˆï¼š**
- **é€‰æ‹©ï¼š** Repository Patternï¼ˆæ¯ä¸ªè¡¨ä¸€ä¸ªRepositoryç±»ï¼‰
- **ç†ç”±ï¼š** æ¸…æ™°çš„æŠ½è±¡ã€æ˜“äºæµ‹è¯•
- **æƒè¡¡ï¼š** æ¨¡æ¿ä»£ç ã€å¯èƒ½è¿‡åº¦æŠ½è±¡

**æ¶æ„å¸ˆï¼ˆæ€§èƒ½ä¸“å®¶ï¼‰å»ºè®®ï¼š**
- **é€‰æ‹©ï¼š** å‡½æ•°å¼æŸ¥è¯¢å¯¼å‡º + Drizzle ORMæŸ¥è¯¢æ„å»ºå™¨
- **ç†ç”±ï¼š**
  - lib/db/queries/tasks.ts: export async function getTasksByFamily(familyId: string) {...}
  - lib/db/queries/users.ts: export async function getUserByPhone(phone: string) {...}
  - ç®€å•ã€ç›´æ¥ã€Bunæ€§èƒ½ä¼˜åŒ–
  - éµå®ˆRED LISTè§„åˆ™
- **æƒè¡¡ï¼š** ç¼ºå°‘RepositoryæŠ½è±¡ï¼Œä½†Drizzleå·²æä¾›ORMæŠ½è±¡

**ADR-5 å†³ç­–ï¼š**
- **é€‰æ‹©ï¼š** å‡½æ•°å¼æŸ¥è¯¢å¯¼å‡ºï¼ˆæŒ‰è¡¨åˆ†æ–‡ä»¶ï¼‰+ Drizzle ORMæŸ¥è¯¢æ„å»ºå™¨
- **ç†ç”±ï¼š**
  1. ä¸¥æ ¼éµå¾ªproject-context.md RED LISTè§„åˆ™
  2. lib/db/queries/ç›®å½•æŒ‰è¡¨åˆ†æ–‡ä»¶ï¼ˆtasks.ts, users.ts, families.tsç­‰ï¼‰
  3. å‡½æ•°å¼APIç®€å•é«˜æ•ˆ
  4. Drizzle ORMæä¾›è¶³å¤Ÿçš„æŠ½è±¡å±‚
- **è®°å½•äººï¼š** Winston
- **æ—¥æœŸï¼š** 2026-02-12
- **çŠ¶æ€ï¼š** å·²é‡‡çº³
- **æ›¿ä»£æ–¹æ¡ˆï¼š** Repository Pattern
- **åæœï¼š** ç¼ºå°‘RepositoryæŠ½è±¡ï¼Œä½†ç¬¦åˆé¡¹ç›®çº¦æŸ

---

## æ¶æ„å†³ç­–åŸåˆ™ï¼ˆä»ADRä¸­æå–ï¼‰

åŸºäºArchitecture Decision Recordsæ–¹æ³•çš„æ·±åº¦åˆ†æï¼Œæå–ä»¥ä¸‹æ ¸å¿ƒæ¶æ„å†³ç­–åŸåˆ™ï¼š

1. **MVPä¼˜å…ˆåŸåˆ™ï¼š** é€‰æ‹©å®ç°ç®€å•ã€å¿«é€Ÿäº¤ä»˜çš„æ–¹æ¡ˆï¼Œæ˜ç¡®é¢„ç•™å‡çº§è·¯å¾„
2. **çº¦æŸéµå®ˆåŸåˆ™ï¼š** ä¸¥æ ¼éµå¾ªproject-context.md RED LISTå’Œé¡¹ç›®ä¸Šä¸‹æ–‡çº¦æŸ
3. **æƒè¡¡è®°å½•åŸåˆ™ï¼š** æ¯ä¸ªå†³ç­–æ˜ç¡®è®°å½•æ›¿ä»£æ–¹æ¡ˆã€æƒè¡¡ã€åæœ
4. **é£é™©å¯æ§åŸåˆ™ï¼š** é€‰æ‹©å·²éªŒè¯ã€æˆç†Ÿçš„æŠ€æœ¯æ ˆï¼Œé™ä½MVPé£é™©
5. **æ¼”è¿›é¢„ç•™åŸåˆ™ï¼š** æ‰€æœ‰æ¶æ„å†³ç­–é¢„ç•™äºŒæœŸã€ä¸‰æœŸå‡çº§è·¯å¾„ï¼ˆå¦‚è½®è¯¢â†’SSEâ†’WebSocketï¼‰

---

## Tree of Thoughts Analysis - Project Context Architecture

### æ¨ç†è·¯å¾„æ¢ç´¢

**è·¯å¾„Aï¼šæ¿€è¿›æ¶æ„è·¯å¾„**
- PostgreSQLç¬¬ä¸€å¤© + WebSocket + Redux + Redis
- ç›®æ ‡ï¼šä»ç¬¬ä¸€å¤©å°±æ”¯æŒ10000+ DAU
- ä¼˜åŠ¿ï¼šç«‹å³æ‰©å±•æ€§ï¼Œæœ€ä½³æ€§èƒ½
- åŠ£åŠ¿ï¼šMVPå¼€å‘å‘¨æœŸé•¿ï¼Œè¿‡åº¦å·¥ç¨‹é£é™©é«˜

**è·¯å¾„Bï¼šä¿å®ˆæ¶æ„è·¯å¾„**
- SQLite + è½®è¯¢ + Zustand + æ— ç¼“å­˜
- ç›®æ ‡ï¼šMVPå¿«é€ŸéªŒè¯ï¼Œæœ€å°å¤æ‚æ€§
- ä¼˜åŠ¿ï¼šå¿«é€Ÿäº¤ä»˜ï¼Œå­¦ä¹ æ›²çº¿ä½
- åŠ£åŠ¿ï¼šç”¨æˆ·å¢é•¿åéœ€è¦é‡æ„ï¼ŒæŠ€æœ¯å€ºåŠ¡ç´¯ç§¯

**è·¯å¾„Cï¼šå¹³è¡¡æ¼”è¿›è·¯å¾„**
- SQLite â†’ PostgreSQLè¿ç§» + è½®è¯¢â†’SSEâ†’WebSocketæ¼”è¿› + Zustand + é¢„ç•™Redisæ¥å£
- ç›®æ ‡ï¼šMVPéªŒè¯ + æ¸…æ™°æ¼”è¿›è·¯å¾„
- ä¼˜åŠ¿ï¼šé£é™©å¯æ§ï¼Œæ¼”è¿›è·¯å¾„æ˜ç¡®
- åŠ£åŠ¿ï¼šéœ€è¦è®¾è®¡è¿ç§»ç­–ç•¥ï¼Œç¨åéœ€è¦é‡æ„éƒ¨åˆ†ä»£ç 

**è·¯å¾„Dï¼šæç®€æ¶æ„è·¯å¾„**
- SQLite + è½®è¯¢ + ç®€å•useState + æ— çŠ¶æ€ç®¡ç†
- ç›®æ ‡ï¼šç»å¯¹æœ€å°åŒ–
- ä¼˜åŠ¿ï¼šé›¶å­¦ä¹ æ›²çº¿ï¼Œæœ€å¿«é€Ÿäº¤ä»˜
- åŠ£åŠ¿ï¼šå®æ—¶åŒæ­¥å’Œç¦»çº¿é˜Ÿåˆ—éš¾ä»¥å®ç°ï¼Œæ‰©å±•æ€§å·®

### è·¯å¾„è¯„ä¼°

| è¯„ä¼°ç»´åº¦ | è·¯å¾„A (æ¿€è¿›) | è·¯å¾„B (ä¿å®ˆ) | è·¯å¾„C (å¹³è¡¡) | è·¯å¾„D (æç®€) |
|---------|--------------|--------------|--------------|--------------|
| **MVPå¼€å‘å‘¨æœŸ** | ğŸ”´ é•¿ (8-12å‘¨) | ğŸŸ¢ çŸ­ (4-6å‘¨) | ğŸŸ¡ ä¸­ (6-8å‘¨) | ğŸŸ¢ çŸ­ (3-4å‘¨) |
| **æ‰©å±•æ€§** | ğŸŸ¢ ä¼˜ç§€ (10000+ DAU) | ğŸŸ¡ ä¸­ (5000 DAUé™åˆ¶) | ğŸŸ¡ ä¸­â†’ä¼˜ (é¢„ç•™æ¼”è¿›) | ğŸ”´ å·® (SQLiteç“¶é¢ˆ) |
| **æŠ€æœ¯å€ºåŠ¡é£é™©** | ğŸŸ¢ ä½ (ä¸€å¼€å§‹å°±å¯¹) | ğŸ”´ é«˜ (åæœŸé‡æ„) | ğŸŸ¡ ä¸­ (éœ€è¦è¿ç§») | ğŸ”´ é«˜ (æ¶æ„å—é™) |
| **ä¸PRDå¯¹é½** | ğŸŸ¡ ä¸­ (è¿‡åº¦å·¥ç¨‹) | ğŸŸ¢ ä¼˜ç§€ (5000 DAUæ»¡è¶³) | ğŸŸ¢ ä¼˜ç§€ (æ¸…æ™°æ¼”è¿›) | ğŸ”´ å·® (å®æ—¶/ç¦»çº¿éš¾å®ç°) |
| **å›¢é˜Ÿå­¦ä¹ æ›²çº¿** | ğŸ”´ é«˜ (å¤æ‚æ ˆ) | ğŸŸ¢ ä½ (ç†Ÿæ‚‰æŠ€æœ¯) | ğŸŸ¡ ä¸­ (Bun æ–°ä½†ç®€å•) | ğŸŸ¢ ä½ (æœ€ç®€å•) |
| **è¿ç»´å¤æ‚åº¦** | ğŸ”´ é«˜ (å¤šæœåŠ¡) | ğŸŸ¢ ä½ (å•è¿›ç¨‹) | ğŸŸ¡ ä¸­ (é¢„ç•™æ‰©å±•) | ğŸŸ¢ ä½ (æœ€å°åŒ–) |
| **å¼€å‘æ•ˆç‡** | ğŸŸ¡ ä¸­ (é…ç½®å¤æ‚) | ğŸŸ¢ é«˜ (å¿«é€Ÿå¼€å‘) | ğŸŸ¢ é«˜ (MVP å‹å¥½) | ğŸŸ¢ æœ€é«˜ (æœ€ç®€) |
| **æ¨èåº¦** | ğŸŸ¡ å¯é€‰ | ğŸŸ¢ å¯è¡Œ | ğŸŸ¢ **æ¨è** | ğŸ”´ ä¸æ¨è |

**å†³ç­–ï¼šé€‰æ‹©è·¯å¾„ Cï¼ˆå¹³è¡¡æ¼”è¿›è·¯å¾„ï¼‰**

ç†ç”±ï¼š
1. ä¸é¡¹ç›®ä¸Šä¸‹æ–‡å’Œ RED LIST å®Œå…¨å…¼å®¹
2. æ»¡è¶³ PRD è¦æ±‚çš„ 5000 DAU + 3ç§’å»¶è¿Ÿ
3. æ¸…æ™°çš„æ¼”è¿›è·¯å¾„ï¼ˆSQLiteâ†’PostgreSQLï¼Œè½®è¯¢â†’SSEï¼‰
4. é£é™©å¯æ§ï¼ŒMVP äº¤ä»˜å‘¨æœŸåˆç†ï¼ˆ6-8å‘¨ï¼‰

---

## Project Structure & Boundaries

### Complete Project Directory Structure

åŸºäº Cross-Functional War Room æ·±åº¦è¯„å®¡åçš„å¢å¼ºç‰ˆé¡¹ç›®ç»“æ„ï¼š

```
bmad-test2/
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json                    # Bun runtime, Next.js 16.x, Drizzle ORM
â”œâ”€â”€ bun.lock
â”œâ”€â”€ next.config.ts                  # Next.js 16 + PWA é…ç½®
â”œâ”€â”€ tsconfig.json                   # TypeScript 5 strict mode
â”œâ”€â”€ tailwind.config.ts              # Tailwind CSS 4 + è‡ªå®šä¹‰ä¸»é¢˜
â”œâ”€â”€ postcss.config.mjs
â”œâ”€â”€ drizzle.config.ts               # Drizzle ORM é…ç½®
â”œâ”€â”€ .env.local                      # æœ¬åœ°ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.example                    # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .cursorrules                    # AI ç¼–ç è§„èŒƒ
â”œâ”€â”€ .prettierrc
â”œâ”€â”€ eslint.config.mjs

# ==========================================
# GitHub CI/CD é…ç½®
# ==========================================
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml                  # ç±»å‹æ£€æŸ¥ + æµ‹è¯•
â”‚       â””â”€â”€ deploy.yml              # è‡ªåŠ¨éƒ¨ç½²

# ==========================================
# æ•°æ®åº“ (bun:sqlite + Drizzle ORM)
# ==========================================
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema/                     # Drizzle è¡¨å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ index.ts                # å¯¼å‡ºæ‰€æœ‰è¡¨
â”‚   â”‚   â”œâ”€â”€ users.ts                # ç”¨æˆ·è¡¨ (å®¶é•¿/å„¿ç«¥/Admin)
â”‚   â”‚   â”œâ”€â”€ families.ts             # å®¶åº­è¡¨
â”‚   â”‚   â”œâ”€â”€ task-plans.ts           # è®¡åˆ’ä»»åŠ¡æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ tasks.ts                # ä»»åŠ¡å®ä¾‹
â”‚   â”‚   â”œâ”€â”€ points.ts               # ç§¯åˆ†è®°å½•
â”‚   â”‚   â”œâ”€â”€ point-balances.ts       # ç§¯åˆ†ä½™é¢
â”‚   â”‚   â”œâ”€â”€ wishlists.ts            # æ„¿æœ›å•
â”‚   â”‚   â”œâ”€â”€ wishlist-items.ts       # æ„¿æœ›é¡¹
â”‚   â”‚   â”œâ”€â”€ combos.ts               # Combo è®°å½•
â”‚   â”‚   â”œâ”€â”€ badges.ts               # å¾½ç« å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ user-badges.ts          # ç”¨æˆ·å¾½ç« 
â”‚   â”‚   â”œâ”€â”€ checkins.ts             # ç­¾åˆ°è®°å½•
â”‚   â”‚   â”œâ”€â”€ notifications.ts        # é€šçŸ¥
â”‚   â”‚   â”œâ”€â”€ admin-templates.ts      # ç®¡ç†å‘˜æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ sessions.ts             # Better-Auth ä¼šè¯
â”‚   â”‚
â”‚   â”œâ”€â”€ migrations/                 # Drizzle è¿ç§»æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ *.sql
â”‚   â”‚
â”‚   â””â”€â”€ seed/                       # æµ‹è¯•æ•°æ®ç§å­
â”‚       â””â”€â”€ seed.ts

# ==========================================
# æºä»£ç 
# ==========================================
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ app/                        # Next.js App Router
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # æ ¹å¸ƒå±€ (Provider æ³¨å…¥)
â”‚   â”‚   â”œâ”€â”€ page.tsx                # é¦–é¡µ (è§’è‰²é€‰æ‹©å…¥å£)
â”‚   â”‚   â”œâ”€â”€ globals.css             # å…¨å±€æ ·å¼
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ (auth)/                 # è®¤è¯è·¯ç”±ç»„
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å®¶é•¿æ‰‹æœºå·ç™»å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ pin/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å„¿ç«¥ PIN ç™»å½•
â”‚   â”‚   â”‚   â””â”€â”€ layout.tsx          # è®¤è¯å¸ƒå±€
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ (parent)/               # å®¶é•¿ç«¯è·¯ç”±ç»„ (å°ç¨‹åºä¼˜åŒ–)
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx          # å®¶é•¿ç«¯å¸ƒå±€ (åº•éƒ¨å¯¼èˆª)
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å®¶é•¿ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx        # ä»»åŠ¡åˆ—è¡¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ create/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx    # åˆ›å»ºè®¡åˆ’ä»»åŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx    # ä»»åŠ¡è¯¦æƒ…/ç¼–è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ approvals/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å®¡æ‰¹ä¸­å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ points/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # ç§¯åˆ†ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ wishlist/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx        # æ„¿æœ›å•ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ review/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx    # æ„¿æœ›å®¡æ ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ children/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å­©å­ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # æ•°æ®åˆ†æ
â”‚   â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx        # å®¶åº­è®¾ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ (child)/                # å„¿ç«¥ç«¯è·¯ç”±ç»„ (å¹³æ¿ä¼˜åŒ–)
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx          # å„¿ç«¥ç«¯å¸ƒå±€ (æ¸¸æˆåŒ–ä¸»é¢˜)
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å„¿ç«¥ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # æˆ‘çš„ä»»åŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ points/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # æˆ‘çš„ç§¯åˆ†
â”‚   â”‚   â”‚   â”œâ”€â”€ wishlist/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx        # æˆ‘çš„æ„¿æœ›
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ create/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx    # åˆ›å»ºæ„¿æœ›
â”‚   â”‚   â”‚   â”œâ”€â”€ badges/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å¾½ç« å¢™
â”‚   â”‚   â”‚   â”œâ”€â”€ checkin/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # æ¯æ—¥ç­¾åˆ°
â”‚   â”‚   â”‚   â””â”€â”€ profile/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx        # ä¸ªäººèµ„æ–™
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/                  # ç®¡ç†å‘˜ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx          # ç®¡ç†å‘˜å¸ƒå±€
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # ç®¡ç†ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # æ¨¡æ¿ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ families/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å®¶åº­å®¡æ ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # å›¾åºŠç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ stats/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx        # å…¨å±€ç»Ÿè®¡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ api/                    # API Routes
â”‚   â”‚       â”œâ”€â”€ auth/
â”‚   â”‚       â”‚   â””â”€â”€ [...nextauth]/   # Better-Auth è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ tasks/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts
â”‚   â”‚       â”œâ”€â”€ points/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts
â”‚   â”‚       â”œâ”€â”€ wishlists/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts
â”‚   â”‚       â”œâ”€â”€ notifications/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts
â”‚   â”‚       â””â”€â”€ admin/
â”‚   â”‚           â””â”€â”€ route.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                 # React ç»„ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ui/                     # Shadcn UI ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ dialog.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ select.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ table.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ tabs.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ toast.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ progress.tsx        # è¿›åº¦æ¡ (æ„¿æœ›è¿›åº¦)
â”‚   â”‚   â”‚   â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ avatar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ calendar.tsx        # æ—¥æœŸé€‰æ‹©
â”‚   â”‚   â”‚   â”œâ”€â”€ checkbox.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ dropdown-menu.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ form.tsx            # è¡¨å•åŒ…è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ label.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ scroll-area.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ separator.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ sheet.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ skeleton.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ switch.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ tooltip.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ forms/                  # è¡¨å•ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ task-plan-form.tsx  # è®¡åˆ’ä»»åŠ¡è¡¨å•
â”‚   â”‚   â”‚   â”œâ”€â”€ wish-form.tsx       # æ„¿æœ›è¡¨å•
â”‚   â”‚   â”‚   â”œâ”€â”€ family-form.tsx     # å®¶åº­è®¾ç½®è¡¨å•
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ features/               # åŠŸèƒ½ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ task-card.tsx       # ä»»åŠ¡å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ task-list.tsx       # ä»»åŠ¡åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ wish-card.tsx       # æ„¿æœ›å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ wish-progress.tsx   # æ„¿æœ›è¿›åº¦æ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ points-display.tsx  # ç§¯åˆ†æ˜¾ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ combo-display.tsx   # Combo æ˜¾ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ badge-showcase.tsx  # å¾½ç« å±•ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ checkin-button.tsx  # ç­¾åˆ°æŒ‰é’®
â”‚   â”‚   â”‚   â”œâ”€â”€ notification-list.tsx # é€šçŸ¥åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ layouts/                # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ parent-nav.tsx      # å®¶é•¿ç«¯å¯¼èˆª
â”‚   â”‚   â”‚   â”œâ”€â”€ child-nav.tsx       # å„¿ç«¥ç«¯å¯¼èˆª
â”‚   â”‚   â”‚   â”œâ”€â”€ admin-nav.tsx       # ç®¡ç†å‘˜å¯¼èˆª
â”‚   â”‚   â”‚   â”œâ”€â”€ header.tsx          # é€šç”¨å¤´éƒ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ footer.tsx          # é€šç”¨åº•éƒ¨
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ gamification/           # æ¸¸æˆåŒ–ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ confetti.tsx        # åº†ç¥åŠ¨ç”»
â”‚   â”‚       â”œâ”€â”€ level-up-modal.tsx  # å‡çº§å¼¹çª—
â”‚   â”‚       â”œâ”€â”€ badge-earned.tsx    # å¾½ç« è·å¾—
â”‚   â”‚       â”œâ”€â”€ combo-streak.tsx    # Combo è¿å‡»
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                        # å·¥å…·åº“
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ db/                     # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts            # Drizzle å®ä¾‹å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.ts           # è¡¨å®šä¹‰å¯¼å‡º
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ queries/            # æŒ‰è¡¨åˆ†æ–‡ä»¶çš„æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ users.ts        # ç”¨æˆ·æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ families.ts     # å®¶åº­æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ tasks.ts        # ä»»åŠ¡æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ points.ts       # ç§¯åˆ†æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ wishlists.ts    # æ„¿æœ›æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ combos.ts       # Combo æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ badges.ts       # å¾½ç« æŸ¥è¯¢
â”‚   â”‚   â”‚       â”œâ”€â”€ notifications.ts # é€šçŸ¥æŸ¥è¯¢
â”‚   â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ auth/                   # è®¤è¯
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts            # Better-Auth é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ session.ts          # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ guards.ts           # æƒé™å®ˆå«
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ task-engine.ts      # ä»»åŠ¡æ—¥æœŸç­–ç•¥å¼•æ“
â”‚   â”‚   â”‚   â”œâ”€â”€ points-calculator.ts # ç§¯åˆ†è®¡ç®—æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ combo-tracker.ts    # Combo è¿½è¸ªæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ notification-sender.ts # é€šçŸ¥å‘é€
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ hooks/                  # React Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ use-auth.ts         # è®¤è¯çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ use-tasks.ts        # ä»»åŠ¡æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ use-points.ts       # ç§¯åˆ†æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ use-wishlist.ts     # æ„¿æœ›æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ use-notifications.ts # é€šçŸ¥
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ store/                  # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ auth-store.ts       # è®¤è¯çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ task-store.ts       # ä»»åŠ¡çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ points-store.ts     # ç§¯åˆ†çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ wishlist-store.ts   # æ„¿æœ›çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ notification-store.ts # é€šçŸ¥çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ cn.ts               # Tailwind ç±»åˆå¹¶
â”‚   â”‚   â”‚   â”œâ”€â”€ date.ts             # æ—¥æœŸå¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ validators.ts       # æ•°æ®éªŒè¯
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters.ts       # æ ¼å¼åŒ– (ç§¯åˆ†ã€æ—¥æœŸ)
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ constants/              # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ error-codes.ts      # é”™è¯¯ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ routes.ts           # è·¯ç”±å¸¸é‡
â”‚   â”‚   â”‚   â”œâ”€â”€ roles.ts            # è§’è‰²å¸¸é‡
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts              # API ç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ dto.ts              # DTO ç±»å‹
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ notifications/          # é€šçŸ¥ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ push.ts             # æ¨é€æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ email.ts            # é‚®ä»¶æœåŠ¡ (é¢„ç•™)
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ offline/                # ç¦»çº¿é˜Ÿåˆ—ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ queue.ts            # æ“ä½œé˜Ÿåˆ— (IndexedDB)
â”‚   â”‚   â”‚   â”œâ”€â”€ sync.ts             # åŒæ­¥ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ conflict-resolver.ts # å†²çªè§£å†³
â”‚   â”‚   â”‚   â”œâ”€â”€ network-status.ts   # ç½‘ç»œçŠ¶æ€æ£€æµ‹
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ privacy/                # éšç§åˆè§„å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ data-guard.ts       # æ•°æ®è„±æ•
â”‚   â”‚   â”‚   â”œâ”€â”€ consent-manager.ts  # å®¶é•¿åŒæ„ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ retention-policy.ts # æ•°æ®ç•™å­˜ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ coppa-compliance.ts # COPPA åˆè§„æ£€æŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ gdpr-compliance.ts  # GDPR åˆè§„æ£€æŸ¥
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ gamification/           # æ¸¸æˆåŒ–é€»è¾‘
â”‚   â”‚       â”œâ”€â”€ level-system.ts     # ç­‰çº§ç³»ç»Ÿ
â”‚   â”‚       â”œâ”€â”€ badge-system.ts     # å¾½ç« ç³»ç»Ÿ
â”‚   â”‚       â”œâ”€â”€ combo-system.ts     # Combo ç³»ç»Ÿ
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                      # å…¨å±€ç±»å‹
â”‚   â”‚   â”œâ”€â”€ task.ts                 # ä»»åŠ¡ç±»å‹
â”‚   â”‚   â”œâ”€â”€ user.ts                 # ç”¨æˆ·ç±»å‹
â”‚   â”‚   â”œâ”€â”€ points.ts               # ç§¯åˆ†ç±»å‹
â”‚   â”‚   â”œâ”€â”€ wishlist.ts             # æ„¿æœ›ç±»å‹
â”‚   â”‚   â”œâ”€â”€ gamification.ts         # æ¸¸æˆåŒ–ç±»å‹
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â””â”€â”€ middleware.ts               # Next.js ä¸­é—´ä»¶
â”‚                                   # (è§’è‰²è·¯ç”±å®ˆå«ã€i18n)
â”‚
# ==========================================
# æµ‹è¯• (Bun Test + Playwright)
# ==========================================
â”œâ”€â”€ tests/
â”‚   â”‚
â”‚   â”œâ”€â”€ unit/                       # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚
â”‚   â”œâ”€â”€ integration/                # é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ workflows/
â”‚   â”‚
â”‚   â”œâ”€â”€ e2e/                        # E2E æµ‹è¯• (Playwright)
â”‚   â”‚   â”œâ”€â”€ auth.spec.ts
â”‚   â”‚   â”œâ”€â”€ tasks.spec.ts
â”‚   â”‚   â”œâ”€â”€ points.spec.ts
â”‚   â”‚   â”œâ”€â”€ wishlist.spec.ts
â”‚   â”‚   â””â”€â”€ gamification.spec.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ fixtures/                   # æµ‹è¯•æ•°æ®
â”‚   â”‚   â”œâ”€â”€ users.ts
â”‚   â”‚   â”œâ”€â”€ tasks.ts
â”‚   â”‚   â””â”€â”€ families.ts
â”‚   â”‚
â”‚   â””â”€â”€ utils/                      # æµ‹è¯•å·¥å…·
â”‚       â”œâ”€â”€ test-db.ts
â”‚       â””â”€â”€ helpers.ts

# ==========================================
# PWA & é™æ€èµ„æº
# ==========================================
â”œâ”€â”€ public/
â”‚   â”‚
â”‚   â”œâ”€â”€ manifest.json               # PWA Manifest
â”‚   â”‚
â”‚   â”œâ”€â”€ sw/                         # Service Worker æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ sw.js                   # å…¥å£
â”‚   â”‚   â”œâ”€â”€ cache-strategy.js       # ç¼“å­˜ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ push-handler.js         # æ¨é€å¤„ç†
â”‚   â”‚   â”œâ”€â”€ sync-handler.js         # åå°åŒæ­¥
â”‚   â”‚   â””â”€â”€ offline-fallback.html   # ç¦»çº¿å›é€€é¡µé¢
â”‚   â”‚
â”‚   â”œâ”€â”€ icons/                      # PWA å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ icon-192x192.png
â”‚   â”‚   â”œâ”€â”€ icon-512x512.png
â”‚   â”‚   â””â”€â”€ apple-touch-icon.png
â”‚   â”‚
â”‚   â”œâ”€â”€ images/                     # åº”ç”¨å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ badges/                 # å¾½ç« å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ avatars/                # é»˜è®¤å¤´åƒ
â”‚   â”‚   â””â”€â”€ illustrations/          # æ’ç”»
â”‚   â”‚
â”‚   â””â”€â”€ fonts/                      # å­—ä½“æ–‡ä»¶

# ==========================================
# æ–‡æ¡£
# ==========================================
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md             # æ¶æ„æ–‡æ¡£
â”‚   â”œâ”€â”€ API.md                      # API æ–‡æ¡£
â”‚   â”œâ”€â”€ DEPLOYMENT.md               # éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ TESTING.md                  # æµ‹è¯•æŒ‡å—

# ==========================================
# è„šæœ¬ä¸å·¥å…·
# ==========================================
â””â”€â”€ scripts/
    â”œâ”€â”€ db-migrate.ts               # æ•°æ®åº“è¿ç§»è„šæœ¬
    â”œâ”€â”€ db-seed.ts                  # æ•°æ®ç§å­è„šæœ¬
    â””â”€â”€ db-backup.ts                # æ•°æ®åº“å¤‡ä»½
```

### Architectural Boundaries

**API Boundaries:**

| è¾¹ç•Œ | ç«¯ç‚¹æ¨¡å¼ | è®¤è¯è¦æ±‚ | è¯´æ˜ |
|------|----------|----------|------|
| **å…¬å…± API** | `/api/auth/**` | æ—  | ç™»å½•ã€æ³¨å†Œã€ä¼šè¯ç®¡ç† |
| **å®¶é•¿ API** | `/api/parent/**` | Parent è§’è‰² | ä»»åŠ¡ç®¡ç†ã€å®¡æ‰¹ã€å®¶åº­è®¾ç½® |
| **å„¿ç«¥ API** | `/api/child/**` | Child è§’è‰² | ä»»åŠ¡æŸ¥çœ‹ã€æ„¿æœ›ç®¡ç† |
| **ç®¡ç†å‘˜ API** | `/api/admin/**` | Admin è§’è‰² | æ¨¡æ¿ç®¡ç†ã€å…¨å±€ç»Ÿè®¡ |
| **å®æ—¶ API** | `/api/sync/**` | ä»»æ„è§’è‰² | è½®è¯¢åŒæ­¥ç«¯ç‚¹ |

**Component Boundaries:**

| è¾¹ç•Œç±»å‹ | æ¨¡å¼ | æŠ€æœ¯å®ç° |
|----------|------|----------|
| **å®¶é•¿ç«¯ â†” å„¿ç«¥ç«¯** | å…±äº«çŠ¶æ€ + ç‹¬ç«‹è§†å›¾ | Zustand + å“åº”å¼å¸ƒå±€ |
| **åœ¨çº¿ â†” ç¦»çº¿** | ä¹è§‚ UI + é˜Ÿåˆ— | IndexedDB + Background Sync |
| **å‰ç«¯ â†” åç«¯** | REST API + è½®è¯¢ | Next.js API Routes |

**Service Boundaries:**

- **Task Engine**: æ—¥æœŸç­–ç•¥å¼•æ“ï¼Œå¤„ç†ä»»åŠ¡å®ä¾‹ç”Ÿæˆé€»è¾‘
- **Points Calculator**: ç§¯åˆ†ç»“ç®—æœåŠ¡ï¼Œç¡®ä¿çº¿æ€§å åŠ ä¸å›é€€
- **Combo Tracker**: è¿ç»­å®Œæˆè¿½è¸ªï¼Œæ”¯æŒå®½é™æœºåˆ¶
- **Notification Sender**: å¤šæ¸ é“é€šçŸ¥å‘é€ï¼ˆåº”ç”¨å†…ã€æ¨é€ï¼‰

**Data Boundaries:**

| è¾¹ç•Œ | è®¿é—®æ¨¡å¼ | ä¸€è‡´æ€§ç­–ç•¥ |
|------|----------|------------|
| **SQLite æ•°æ®åº“** | Drizzle ORM æŸ¥è¯¢æ„å»ºå™¨ | äº‹åŠ¡ä¿è¯ |
| **å‰ç«¯çŠ¶æ€** | Zustand + React Query | ä¹è§‚æ›´æ–° + åŒæ­¥ç¡®è®¤ |
| **ç¦»çº¿é˜Ÿåˆ—** | IndexedDB | æ—¶é—´æˆ³å†²çªè§£å†³ |

### Requirements to Structure Mapping

**Feature/Epic Mapping:**

| Epic | ç»„ä»¶ä½ç½® | æœåŠ¡ä½ç½® | API ä½ç½® | ç±»å‹å®šä¹‰ |
|------|----------|----------|----------|----------|
| **ç”¨æˆ·ç®¡ç†** | `app/(auth)/**` | `lib/auth/**` | `app/api/auth/**` | `types/user.ts` |
| **ä»»åŠ¡ç®¡ç†** | `app/(parent)/tasks/**`, `app/(child)/tasks/**` | `lib/services/task-engine.ts` | `app/api/tasks/**` | `types/task.ts` |
| **ç§¯åˆ†ç³»ç»Ÿ** | `components/features/points-display.tsx` | `lib/services/points-calculator.ts` | `app/api/points/**` | `types/points.ts` |
| **æ„¿æœ›ç³»ç»Ÿ** | `app/(parent)/wishlist/**`, `app/(child)/wishlist/**` | `lib/db/queries/wishlists.ts` | `app/api/wishlists/**` | `types/wishlist.ts` |
| **Combo æ¿€åŠ±** | `components/features/combo-display.tsx` | `lib/services/combo-tracker.ts`, `lib/gamification/combo-system.ts` | - | `types/gamification.ts` |
| **æ¸¸æˆåŒ–** | `components/gamification/**`, `app/(child)/badges/**` | `lib/gamification/**` | `app/api/gamification/**` | `types/gamification.ts` |
| **ç®¡ç†å‘˜åŠŸèƒ½** | `app/admin/**` | `lib/admin/**` | `app/api/admin/**` | - |

**Cross-Cutting Concerns:**

| å…³æ³¨ç‚¹ | ä½ç½® | è¯´æ˜ |
|--------|------|------|
| **è®¤è¯ç³»ç»Ÿ** | `lib/auth/**`, `middleware.ts` | Better-Auth + è§’è‰²å®ˆå« |
| **ç¦»çº¿æ”¯æŒ** | `lib/offline/**`, `public/sw/**` | IndexedDB + Background Sync |
| **éšç§åˆè§„** | `lib/privacy/**` | COPPA/GDPR/ä¸­å›½å„¿ç«¥ä¿æŠ¤ |
| **é€šçŸ¥ç³»ç»Ÿ** | `lib/notifications/**` | æ¨é€ + åº”ç”¨å†…é€šçŸ¥ |
| **é”™è¯¯å¤„ç†** | `lib/constants/error-codes.ts` | ç»Ÿä¸€é”™è¯¯ç  |

### Integration Points

**Internal Communication:**

```
ç”¨æˆ·æ“ä½œ â†’ ä¹è§‚ UI æ›´æ–° â†’ API è¯·æ±‚ â†’ Drizzle ORM â†’ bun:sqlite
              â†“              â†“
         IndexedDB é˜Ÿåˆ—   åç«¯éªŒè¯
              â†“              â†“
         ç¦»çº¿æ—¶æš‚å­˜      æ•°æ®æŒä¹…åŒ–
              â†“              â†“
         ç½‘ç»œæ¢å¤åŒæ­¥ â†’ å†²çªè§£å†³ â†’ çŠ¶æ€æ›´æ–°
```

**External Integrations (é¢„ç•™):**

- **çŸ­ä¿¡æœåŠ¡**: Better-Auth phone æ’ä»¶
- **æ¨é€é€šçŸ¥**: Web Push API
- **å›¾åºŠæœåŠ¡**: ç®¡ç†å‘˜åŠŸèƒ½ï¼ˆè…¾è®¯äº‘ COS / é˜¿é‡Œäº‘ OSSï¼‰

**Data Flow:**

1. **å†™æ“ä½œæµ**: ç”¨æˆ·æ“ä½œ â†’ Zustand ä¹è§‚æ›´æ–° â†’ IndexedDB é˜Ÿåˆ— â†’ API è¯·æ±‚ â†’ åç«¯éªŒè¯ â†’ SQLite æŒä¹…åŒ– â†’ å“åº”ç¡®è®¤ â†’ Zustand çŠ¶æ€åŒæ­¥
2. **è¯»æ“ä½œæµ**: ç»„ä»¶è®¢é˜… Zustand â†’ ç¼“å­˜ä¼˜å…ˆ â†’ API è·å– â†’ Drizzle æŸ¥è¯¢ â†’ æ•°æ®è¿”å› â†’ Zustand æ›´æ–° â†’ ç»„ä»¶é‡æ¸²æŸ“
3. **ç¦»çº¿æµ**: ç½‘ç»œæ–­å¼€ â†’ æ“ä½œå…¥é˜Ÿåˆ— â†’ ä¹è§‚ UI åé¦ˆ â†’ ç½‘ç»œæ¢å¤ â†’ æ‰¹é‡åŒæ­¥ â†’ å†²çªè§£å†³ â†’ æ•°æ®åˆå¹¶

### File Organization Patterns

**Configuration Files:**

- **æ ¹ç›®å½•**: é¡¹ç›®çº§é…ç½®ï¼ˆpackage.json, tsconfig.json, next.config.tsï¼‰
- **æ•°æ®åº“é…ç½®**: `drizzle.config.ts`, `database/schema/`
- **CI/CD**: `.github/workflows/`

**Source Organization:**

- **Next.js çº¦å®š**: `app/` ç›®å½•ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè·¯ç”±
- **ç»„ä»¶åˆ†å±‚**: `ui/` (åŸºç¡€) â†’ `forms/` (å¤åˆ) â†’ `features/` (ä¸šåŠ¡) â†’ `gamification/` (é¢†åŸŸ)
- **åº“å‡½æ•°**: `db/` (æ•°æ®), `services/` (ä¸šåŠ¡), `utils/` (é€šç”¨), `hooks/` (React), `store/` (çŠ¶æ€)

**Test Organization:**

- **å•å…ƒæµ‹è¯•**: ä¸æºæ–‡ä»¶å¹³è¡Œç»“æ„ï¼Œæµ‹è¯•å•ä¸ªå‡½æ•°/ç»„ä»¶
- **é›†æˆæµ‹è¯•**: æµ‹è¯• API ç«¯ç‚¹å’Œæ•°æ®æµ
- **E2E æµ‹è¯•**: Playwright æµ‹è¯•å®Œæ•´ç”¨æˆ·æ—…ç¨‹

**Asset Organization:**

- **PWA èµ„æº**: `public/manifest.json`, `public/sw/**`, `public/icons/`
- **é™æ€å›¾ç‰‡**: æŒ‰ç”¨é€”åˆ†ç›®å½•ï¼ˆbadges/, avatars/, illustrations/ï¼‰

### Development Workflow Integration

**Development Server Structure:**

```bash
bun dev          # å¯åŠ¨ Next.js å¼€å‘æœåŠ¡å™¨
bun db:studio    # Drizzle Studio æ•°æ®åº“ç®¡ç†
bun test         # Bun Test å•å…ƒ/é›†æˆæµ‹è¯•
bun test:e2e     # Playwright E2E æµ‹è¯•
```

**Build Process Structure:**

```bash
bun build        # Next.js æ„å»º (SSG/SSR)
bun db:migrate   # æ•°æ®åº“è¿ç§»
bun db:seed      # æµ‹è¯•æ•°æ®å¡«å……
```

**Deployment Structure:**

- **é™æ€å¯¼å‡º**: `out/` ç›®å½• (Vercel/Netlify)
- **Node æœåŠ¡å™¨**: `.next/` ç›®å½• (ä¼ ç»Ÿæ‰˜ç®¡)
- **Docker**: å¤šé˜¶æ®µæ„å»º (Bun è¿è¡Œæ—¶ + SQLite å·æŒ‚è½½)

---

*Project Structure & Boundaries section added via Advanced Elicitation (Cross-Functional War Room) - Step 6 Complete*

---

## Architecture Validation Results

### Coherence Validation âœ…

**Decision Compatibility:**

| æŠ€æœ¯æ ˆç»„åˆ | çŠ¶æ€ | éªŒè¯ç»“æœ |
|------------|------|----------|
| Bun 1.3.x + Next.js 16.x + React 19.x | âœ… å…¼å®¹ | å®˜æ–¹æ”¯æŒï¼Œç‰ˆæœ¬é”å®š |
| bun:sqlite + Drizzle ORM 0.45.x | âœ… å…¼å®¹ | é›¶é…ç½®ï¼ŒBun åŸç”Ÿé©±åŠ¨ |
| Better-Auth 1.4.x + phone æ’ä»¶ | âœ… å…¼å®¹ | Bun è¿è¡Œæ—¶å®Œå…¨æ”¯æŒ |
| Zustand + React 19 | âœ… å…¼å®¹ | æœ€æ–°ç‰ˆæœ¬å·²é€‚é… React 19 |
| Tailwind CSS 4 + Shadcn UI 3.7 | âœ… å…¼å®¹ | Next.js 16 å®˜æ–¹æ¨è |

**æ‰€æœ‰æŠ€æœ¯å†³ç­–æ— å†²çªï¼Œç‰ˆæœ¬å…¼å®¹ã€‚**

**Pattern Consistency:**

- âœ… **Drizzle ORM å¼ºåˆ¶ä½¿ç”¨**: `lib/db/queries/` æŒ‰è¡¨åˆ†æ–‡ä»¶æ¨¡å¼ç¬¦åˆ RED LIST è§„åˆ™
- âœ… **å‡½æ•°å¼æŸ¥è¯¢**: æ‰€æœ‰æ•°æ®åº“æ“ä½œé€šè¿‡å¯¼å‡ºå‡½æ•°è€Œé Repository ç±»
- âœ… **BDD å¼€å‘**: æµ‹è¯•ç›®å½•ç»“æ„ä¸ Bun Test + Playwright å®Œç¾é…åˆ
- âœ… **å‘½åçº¦å®š**: kebab-case æ–‡ä»¶, camelCase å‡½æ•°, PascalCase ç»„ä»¶å…¨é¡¹ç›®ç»Ÿä¸€

**Structure Alignment:**

- âœ… **è·¯ç”±ç»„è®¾è®¡**: `(parent)`/`(child)`/`(admin)` ç‹¬ç«‹å¸ƒå±€æ”¯æŒåŒç«¯å·®å¼‚åŒ–
- âœ… **ç¦»çº¿/éšç§æ¨¡å—**: `lib/offline/` å’Œ `lib/privacy/` æ”¯æŒ PWA å’Œåˆè§„è¦æ±‚
- âœ… **Service Worker æ¨¡å—åŒ–**: `public/sw/` ç›®å½•ç»“æ„æ”¯æŒå¤æ‚ç¦»çº¿é€»è¾‘

### Requirements Coverage Validation âœ…

**Epic Coverage:**

| Epic | çŠ¶æ€ | æ¶æ„æ”¯æŒéªŒè¯ |
|------|------|--------------|
| ç”¨æˆ·ç®¡ç† (FR1-7) | âœ… å·²è¦†ç›– | `lib/auth/`, `lib/db/queries/users.ts`, Better-Auth é…ç½® |
| ä»»åŠ¡ç®¡ç† (FR8-19) | âœ… å·²è¦†ç›– | `lib/services/task-engine.ts`, æ—¥æœŸç­–ç•¥å¼•æ“ï¼Œæ¨¡æ¿ç³»ç»Ÿ |
| ç§¯åˆ†ç³»ç»Ÿ (FR20-28) | âœ… å·²è¦†ç›– | `lib/services/points-calculator.ts`, çº¿æ€§å åŠ ä¸å›é€€è®¾è®¡ |
| æ„¿æœ›ç³»ç»Ÿ (FR29-37) | âœ… å·²è¦†ç›– | `lib/db/queries/wishlists.ts`, è¿›åº¦æ¡å¯è§†åŒ–ç»„ä»¶ |
| Combo æ¿€åŠ± (FR38-43) | âœ… å·²è¦†ç›– | `lib/services/combo-tracker.ts`, å®½é™æœºåˆ¶ï¼Œä¸­æ–­è­¦æŠ¥ |
| æ¸¸æˆåŒ– (FR44-48) | âœ… å·²è¦†ç›– | `lib/gamification/`, å¾½ç« /ç­‰çº§/ç­¾åˆ°ç³»ç»Ÿå®Œæ•´ |
| ç®¡ç†å‘˜åŠŸèƒ½ (FR49-54) | âœ… å·²è¦†ç›– | `app/admin/`, æ¨¡æ¿ç®¡ç†, å®¶åº­å®¡æ ¸, å›¾åºŠç®¡ç† |
| é€šçŸ¥ä¸è®¾ç½® (FR55-60) | âœ… å·²è¦†ç›– | `lib/notifications/`, é›†ä¸­é€šçŸ¥ä¸­å¿ƒ, å®¶åº­è§„åˆ™é…ç½® |

**æ‰€æœ‰ 60 ä¸ªåŠŸèƒ½éœ€æ±‚å·²å®Œæ•´æ˜ å°„åˆ°æ¶æ„ç»„ä»¶ã€‚**

**Functional Requirements Coverage:**

- âœ… **ä»»åŠ¡æ—¥æœŸç­–ç•¥å¼•æ“**: æ”¯æŒ weekday/weekend/daily/weekly/monthly ç­–ç•¥
- âœ… **ç§¯åˆ†å®¡æ‰¹æµç¨‹**: ä»»åŠ¡å®Œæˆ â†’ å®¶é•¿å®¡æ‰¹ â†’ ç§¯åˆ†ç»“ç®— â†’ å†å²è®°å½•
- âœ… **æ„¿æœ›å…‘æ¢æœºåˆ¶**: ç§¯åˆ†é—¨æ§›æ£€æŸ¥ â†’ å®¶é•¿å®¡æ ¸ â†’ æ ‡è®°å®Œæˆ/å…‘æ¢
- âœ… **Combo å®½é™æœºåˆ¶**: è¿ç»­å®Œæˆè¿½è¸ª + 1æ¬¡å®½é™ + ä¸­æ–­è­¦æŠ¥
- âœ… **ç¦»çº¿é˜Ÿåˆ—**: IndexedDB å­˜å‚¨ + Background Sync API åŒæ­¥
- âœ… **å®æ—¶è½®è¯¢**: 2-3ç§’é—´éš”æ»¡è¶³ <3ç§’å»¶è¿Ÿè¦æ±‚

**Non-Functional Requirements Coverage:**

| NFR | PRD è¦æ±‚ | æ¶æ„æ”¯æŒ | çŠ¶æ€ |
|-----|----------|----------|------|
| **æ€§èƒ½** | å„¿ç«¥ç«¯<2s, API<500ms | Next.js SSG/SSR, SQLite é›¶é…ç½® | âœ… æ»¡è¶³ |
| **å®‰å…¨** | HTTPS/TLS 1.3, RBAC | Better-Auth å®‰å…¨å®è·µ, 36å°æ—¶ä¼šè¯ | âœ… æ»¡è¶³ |
| **åˆè§„** | COPPA/GDPR/ä¸­å›½å„¿ç«¥ä¿æŠ¤ | `lib/privacy/` ä¸“é—¨æ¨¡å—, æ•°æ®è„±æ• | âœ… æ»¡è¶³ |
| **æ‰©å±•æ€§** | 5000 DAU | SQLite â†’ PostgreSQL è¿ç§»è·¯å¾„é¢„ç•™ | âœ… æ»¡è¶³ |
| **ç¦»çº¿** | ç¦»çº¿é˜Ÿåˆ— + åå°åŒæ­¥ | `lib/offline/` + IndexedDB + Background Sync | âœ… æ»¡è¶³ |
| **å®æ—¶** | <3ç§’åŒæ­¥å»¶è¿Ÿ | è½®è¯¢ 2-3ç§’é—´éš”, é¢„ç•™ SSE å‡çº§è·¯å¾„ | âœ… æ»¡è¶³ |

### Implementation Readiness Validation âœ…

**Decision Completeness:**

- âœ… **5ä¸ª ADR å®Œæ•´è®°å½•**:
  - ADR-1: å®æ—¶é€šä¿¡æ¶æ„ï¼ˆè½®è¯¢â†’SSE å‡çº§è·¯å¾„ï¼‰
  - ADR-2: æ•°æ®åº“é€‰æ‹©ï¼ˆSQLite â†’ PostgreSQL æ¼”è¿›ï¼‰
  - ADR-3: è®¤è¯æ¶æ„ï¼ˆBetter-Auth + phone/PINï¼‰
  - ADR-4: ç¦»çº¿é˜Ÿåˆ—ï¼ˆIndexedDB + Background Syncï¼‰
  - ADR-5: æŸ¥è¯¢å±‚æ¶æ„ï¼ˆå‡½æ•°å¼å¯¼å‡º + Drizzle ORMï¼‰

- âœ… **æŠ€æœ¯ç‰ˆæœ¬æ˜ç¡®**: æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬é”å®šï¼Œæ— æ¨¡ç³Šä¾èµ–
- âœ… **Tree of Thoughts åˆ†æ**: 4æ¡è·¯å¾„è¯„ä¼°ï¼Œè·¯å¾„Cï¼ˆå¹³è¡¡æ¼”è¿›ï¼‰æ¨è

**Structure Completeness:**

- âœ… **å®Œæ•´ç›®å½•æ ‘**: 200+ æ–‡ä»¶/ç›®å½•å·²å®šä¹‰ï¼Œæ— å ä½ç¬¦
- âœ… **è¾¹ç•Œæ˜ç¡®**: API/ç»„ä»¶/æœåŠ¡/æ•°æ®è¾¹ç•Œæ¸…æ™°æ–‡æ¡£åŒ–
- âœ… **é›†æˆç‚¹æ˜ å°„**: å†…éƒ¨é€šä¿¡ã€æ•°æ®æµã€ç¬¬ä¸‰æ–¹é›†æˆå®Œæ•´

**Pattern Completeness:**

- âœ… **å‘½åçº¦å®š**: kebab-case æ–‡ä»¶, camelCase å‡½æ•°, PascalCase ç»„ä»¶
- âœ… **é”™è¯¯å¤„ç†**: `lib/constants/error-codes.ts` ç»Ÿä¸€é”™è¯¯ç ä½“ç³»
- âœ… **ä¸€è‡´æ€§è§„åˆ™**: RED LIST 20æ¡è§„åˆ™å¼ºåˆ¶æ‰§è¡Œ
- âœ… **BDD æµ‹è¯•**: Given-When-Then æ ¼å¼ï¼Œå…ˆå†™æµ‹è¯•åå®ç°

### Gap Analysis Results

**å…³é”®å·®è· (Critical Gaps):** æ—  âœ…

**é‡è¦å·®è· (Important Gaps):** æ—  âœ…

**å¯é€‰å¢å¼º (Nice-to-Have):**

| é¡¹ç›® | ä¼˜å…ˆçº§ | è¯´æ˜ | æ—¶æœº |
|------|--------|------|------|
| Redis ç¼“å­˜å±‚ | ä½ | å½“å‰ 5000 DAU ä¸éœ€è¦ | äºŒæœŸç”¨æˆ·å¢é•¿å |
| å¾®æœåŠ¡æ‹†åˆ† | ä½ | å•ä½“æ¶æ„æ»¡è¶³ MVP | ä¸šåŠ¡å¤æ‚åº¦å¢é•¿å |
| Kubernetes éƒ¨ç½² | ä½ | Docker è¶³å¤Ÿ MVP | å¤§è§„æ¨¡éƒ¨ç½²æ—¶ |
| WebSocket å®æ—¶é€šä¿¡ | ä½ | è½®è¯¢æ»¡è¶³å½“å‰éœ€æ±‚ | å®æ—¶æ€§è¦æ±‚æé«˜æ—¶ |

### Validation Issues Addressed

**éªŒè¯è¿‡ç¨‹ä¸­å‘ç°å¹¶è§£å†³çš„é—®é¢˜:**

1. **Service Worker è¿‡äºç®€å•** â†’ å·²å¢å¼ºä¸ºæ¨¡å—åŒ–ç›®å½• `public/sw/`
2. **ç¼ºå°‘ç¦»çº¿é˜Ÿåˆ—ç®¡ç†** â†’ å·²æ·»åŠ  `lib/offline/` ä¸“é—¨æ¨¡å—
3. **éšç§åˆè§„å·¥å…·ç¼ºå¤±** â†’ å·²æ·»åŠ  `lib/privacy/` åˆè§„æ£€æŸ¥æ¨¡å—
4. **å†²çªè§£å†³ç­–ç•¥æœªæ˜ç¡®** â†’ å·²åœ¨ ADR-4 ä¸­æ˜ç¡®æ—¶é—´æˆ³ç­–ç•¥

### Architecture Completeness Checklist

**âœ… Requirements Analysis**

- [x] é¡¹ç›®ä¸Šä¸‹æ–‡å…¨é¢åˆ†æï¼ˆ60ä¸ªFR, æŠ€æœ¯çº¦æŸ, è·¨é¢†åŸŸå…³æ³¨ç‚¹ï¼‰
- [x] è§„æ¨¡å’Œå¤æ‚åº¦è¯„ä¼°ï¼ˆä¸­ç­‰-åé«˜ï¼Œ5000 DAUï¼‰
- [x] æŠ€æœ¯çº¦æŸè¯†åˆ«ï¼ˆBunå¼ºåˆ¶, Drizzleå¼ºåˆ¶, BDDå¼ºåˆ¶ï¼‰
- [x] è·¨é¢†åŸŸå…³æ³¨ç‚¹æ˜ å°„ï¼ˆå®æ—¶åŒæ­¥, ç¦»çº¿é˜Ÿåˆ—, éšç§åˆè§„, åŒç«¯å·®å¼‚åŒ–, ç§¯åˆ†ç»“ç®—ï¼‰

**âœ… Architectural Decisions**

- [x] 5ä¸ªå…³é”®ADRå®Œæ•´è®°å½•ï¼ˆæ•°æ®åº“, å®æ—¶é€šä¿¡, è®¤è¯, ç¦»çº¿, æŸ¥è¯¢å±‚ï¼‰
- [x] æŠ€æœ¯æ ˆå®Œå…¨æŒ‡å®šï¼ˆBun + Next.js + Drizzle + Better-Auth + Zustandï¼‰
- [x] é›†æˆæ¨¡å¼å®šä¹‰ï¼ˆREST API + è½®è¯¢ + é¢„ç•™SSEï¼‰
- [x] æ€§èƒ½è€ƒé‡ï¼ˆSQLiteæ€§èƒ½ä¼˜åŒ–, è½®è¯¢é¢‘ç‡, ç¼“å­˜ç­–ç•¥é¢„ç•™ï¼‰

**âœ… Implementation Patterns**

- [x] å‘½åçº¦å®šå»ºç«‹ï¼ˆæ–‡ä»¶, å‡½æ•°, ç»„ä»¶, ç±»å‹ï¼‰
- [x] ç»“æ„æ¨¡å¼å®šä¹‰ï¼ˆç›®å½•ç»„ç»‡, è·¯ç”±åˆ†ç»„, ç»„ä»¶åˆ†å±‚ï¼‰
- [x] é€šä¿¡æ¨¡å¼æŒ‡å®šï¼ˆAPIè¾¹ç•Œ, çŠ¶æ€ç®¡ç†, ç¦»çº¿åŒæ­¥ï¼‰
- [x] æµç¨‹æ¨¡å¼æ–‡æ¡£åŒ–ï¼ˆé”™è¯¯å¤„ç†, æ•°æ®éªŒè¯, å†²çªè§£å†³ï¼‰

**âœ… Project Structure**

- [x] å®Œæ•´ç›®å½•ç»“æ„å®šä¹‰ï¼ˆ200+ æ–‡ä»¶/ç›®å½•ï¼‰
- [x] ç»„ä»¶è¾¹ç•Œå»ºç«‹ï¼ˆui/forms/features/layouts/gamificationï¼‰
- [x] é›†æˆç‚¹æ˜ å°„ï¼ˆå†…éƒ¨é€šä¿¡, å¤–éƒ¨é›†æˆ, æ•°æ®æµï¼‰
- [x] éœ€æ±‚åˆ°ç»“æ„æ˜ å°„ï¼ˆ8ä¸ªEpicå…¨éƒ¨æ˜ å°„ï¼‰

### Architecture Readiness Assessment

**Overall Status:** âœ… **READY FOR IMPLEMENTATION**ï¼ˆå‡†å¤‡å®æ–½ï¼‰

**Confidence Level:** â­â­â­â­â­ **é«˜** (5/5)

**Key Strengths:**
1. **MVPä¼˜å…ˆ + æ¼”è¿›è·¯å¾„**: å¿«é€Ÿäº¤ä»˜ä¸é•¿æœŸå¯æ‰©å±•æ€§å¹³è¡¡
2. **çº¦æŸæ˜ç¡®**: RED LIST å’Œé¡¹ç›®ä¸Šä¸‹æ–‡å¼ºåˆ¶æ‰§è¡Œï¼Œå‡å°‘ä»£ç†å†²çª
3. **åŒç«¯å·®å¼‚åŒ–**: å®¶é•¿ç«¯å’Œå„¿ç«¥ç«¯ç‹¬ç«‹è·¯ç”±ï¼Œä½“éªŒè´¨é‡ä¿éšœ
4. **åˆè§„å°±ç»ª**: COPPA/GDPR/ä¸­å›½å„¿ç«¥ä¿æŠ¤ä¸“é—¨æ¨¡å—
5. **ç¦»çº¿ä¼˜å…ˆ**: IndexedDB + Background Syncï¼ŒçœŸæ­£æ”¯æŒç¦»çº¿ä½¿ç”¨
6. **Tree of Thoughts åˆ†æ**: 4æ¡è·¯å¾„è¯„ä¼°ï¼Œå†³ç­–æœ‰ç†æœ‰æ®

**Areas for Future Enhancement:**
1. ç”¨æˆ·å¢é•¿è‡³ 10000+ DAU åï¼Œæ‰§è¡Œ SQLite â†’ PostgreSQL è¿ç§»
2. è½®è¯¢æœºåˆ¶å‡çº§è‡³ SSE æˆ– WebSocketï¼ˆå®æ—¶æ€§è¦æ±‚æé«˜æ—¶ï¼‰
3. æ·»åŠ  Redis ç¼“å­˜å±‚ï¼ˆé«˜é¢‘è¯»å–åœºæ™¯ä¼˜åŒ–ï¼‰
4. è€ƒè™‘å¾®æœåŠ¡æ‹†åˆ†ï¼ˆä¸šåŠ¡å¤æ‚åº¦å¢é•¿åï¼‰

### Implementation Handoff

**AI Agent Guidelines:**

1. **ä¸¥æ ¼éµå¾ªæ¶æ„å†³ç­–**: æ‰€æœ‰æŠ€æœ¯é€‰æ‹©æŒ‰ ADR æ‰§è¡Œï¼Œä¸æ“…è‡ªæ›´æ”¹
2. **ä½¿ç”¨æ—¢å®šæ¨¡å¼**: å‘½åçº¦å®šã€ç›®å½•ç»“æ„ã€ç»„ä»¶åˆ†å±‚å¿…é¡»ä¸€è‡´
3. **å°Šé‡é¡¹ç›®è¾¹ç•Œ**: API/ç»„ä»¶/æœåŠ¡/æ•°æ®è¾¹ç•Œä¸å¯è·¨è¶Š
4. **å‚è€ƒæœ¬æ–‡æ¡£**: æ‰€æœ‰æ¶æ„é—®é¢˜ä»¥æœ¬æ–‡æ¡£ä¸ºæœ€ç»ˆä¾æ®
5. **éµå®ˆ RED LIST**: ç¦æ­¢ä½¿ç”¨åŸç”Ÿ SQL, Node.js å…¼å®¹å±‚, `any` ç±»å‹

**First Implementation Priority:**

```bash
# 1. åˆå§‹åŒ–é¡¹ç›®ç»“æ„
bun create next-app@latest . --typescript --tailwind --eslint --app --src-dir
cd . && bun install

# 2. å®‰è£…æ ¸å¿ƒä¾èµ–
bun add drizzle-orm drizzle-kit better-auth next-auth@beta zustand

# 3. åˆå§‹åŒ– Drizzle
bun drizzle-kit init

# 4. è®¾ç½® Better-Auth (å‚ç…§ lib/auth/ é…ç½® phone æ’ä»¶)

# 5. åˆ›å»ºæ•°æ®åº“ Schema (å‚ç…§ database/schema/)

# 6. è¿è¡Œé¦–æ¬¡è¿ç§»
bun drizzle-kit migrate

# 7. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
bun dev
```

**Architecture Document Complete - Step 7 Validation Passed**
