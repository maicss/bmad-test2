## Executive Summary

Family Reward 是一款面向儿童的家庭行为管理游戏平台，通过量化日常行为、游戏化积分系统、愿望兑换（物品+互动体验），帮助家长从"情绪控制"走向"规则共治"，为孩子创造透明、公平、安全的成长环境。

---

## Functional Requirements

_注：以下功能需求将基于之前的研究和Product Brief生成，当前为结构框架，待后续协作细化_

### FR-1: 用户账户与认证系统

**需求描述**：支持家长账户、儿童账户、管理员角色，支持多设备并发登录和PIN码认证。

### FR-2: 任务管理系统

**需求描述**：家长设置计划任务（循环规则、日期规则、积分值），系统自动生成任务。

### FR-3: 积分奖励系统

**需求描述**：好任务完成获得积分，坏任务完成扣除积分；家长可设置奖惩比例。

### FR-4: Combo激励系统

**需求描述**：线性combo（连续完成X次触发）、阶梯combo（每Y次奖励递增），创造"连击快感"。

### FR-5: 愿望兑换系统

**需求描述**：孩子/家长创建愿望（物品+互动体验），进度条显示（当前积分/所需积分），家长确认兑换。

### FR-6: 辅助游戏化

**需求描述**：签到、徽章（铜银金等级）、等级系统、道具卡（9种）、积分银行。

### FR-7: 多孩管理

**需求描述**：支持多个孩子独立数据空间、一键切换账户、共享奖励规则。

### FR-8: 家庭日历与协作

**需求描述**：多视图日历（周/月），智能循环提醒，家庭记忆库。

---

## Non-Functional Requirements

### NFR-1: 性能

**需求描述**：支持5000 DAU，高峰时段17:00-20:00，3秒内家长审批后儿童看到更新。

### NFR-2: 可用性

**需求描述**：PWA支持离线使用，小程序支持推送通知。

### NFR-3: 安全性

**需求描述**：符合COPPA（13岁以下）、GDPR（16岁以下）、中国《儿童个人信息网络保护规定》（14岁以下）。

### NFR-4: 可扩展性

**需求描述**：SQLite作为主存储，Redis作为缓存层，支持高并发。

### NFR-5: 数据留存

**需求描述**：三年合规，用户可查看历史数据，软删除7天可恢复。

### NFR-6: 15岁过渡机制

**需求描述**：基于习惯培养和诚信程度的自主权逐步放开，非硬性年龄切换。

---

## User Scenarios

### 场景1：家长日常管理

**用户**：李妈妈（35岁单亲妈妈）
**流程**：早晨任务设置 → 执行任务 → 晚间总结与奖励/扣分
**流程**：添加愿望 → 指定给儿童和日期 → 展示进度 → 兑换愿望
**需求映射**：FR-1, FR-2, FR-3, FR-4, FR-7

### 场景2：大孩子日常行为

**用户**：王浩（9岁男孩）
**流程**：起床查看任务 → 完成任务获积分 → 查看进度 → 完成任务
**流程**：添加愿望 → 添加到想要兑换的日期 → 查看进度 → 完成的兑换
**需求映射**：FR-1, FR-2, FR-3, FR-5, FR-6

### 场景3：小孩子日常行为

**用户**：王浩（5岁男孩）
**流程**：告诉完成任务获积分/告诉妈妈愿望 → 查看进度 → 完成任务/兑换愿望
**需求映射**：FR-1, FR-2, FR-3, FR-5, FR-6

---

## Product Vision

### 产品定位

**类型**：工具型 + 娱乐型混合定位
**核心价值**：从"情绪控制"走向"规则共治"的家庭教育工具
**差异化优势**：家长全参数控制 + 清晰的产品边界 + 情感连接设计 + 游戏化但保持教育本质

### 情感缓冲机制

**核心差异化**：家长情绪波动时的协商机制

- 家长和孩子可以协商扣分（"我完成了作业但今天有点累，可以少给我5分吗？"）
- 系统记录协商过程，培养孩子沟通理解
- 最终决定权仍在家长，但孩子感到被尊重
- 避免"一次坏行为就全部扣分"的挫败感

### 成长可视化设计（多维度徽章成就体系）

**徽章分类：**

**维度1：任务完成徽章**

- 📚 **阅读小达人**：连续7天完成阅读任务
- 🏹 **运动健将**：连续7天完成运动任务
- 🧹 **家务小能手**：连续7天完成家务任务
- 📝 **学习之星**：连续14天完成学习任务
- 🎸️ **全能表现**：7天内完成所有类型任务

**维度2：习惯养成徽章**

- 🔥 **坚持不懈**：连续30天每日签到
- 🌟 **早起鸟**：连续21天早晨7点前完成任务
- 📚 **睡前阅读**：连续30天睡前阅读习惯
- 📝 **作业达人**：连续14天按时完成作业

**维度3：行为品质徽章**

- ✨ **诚实守信**：连续7天无说谎记录
- 🤝 **情绪稳定**：连续14天无发脾气记录
- 💝 **积极向上**：连续7天获得正面情绪评价
- 🤝 **乐于助人**：连续7天主动帮助他人

**维度4：里程碑徽章**

- 🎖 **首次成就**：第一次完成任务/第一次获得10颗星
- ⭐ **百星达人**：累计获得100颗星
- 💎 **千星里程碑**：累计获得1000颗星
- 🏆 **等级晋升**：从铜→银→金→钻石，每次晋升有特效动画

**维度5：社交徽章**

- 👨 **家庭小帮手**：协助兄弟姐妹完成任务5次
- 🏃 **协作精神**：参与家庭集体活动10次
- 💬 **分享达人**：主动分享成就3次
- ❤️ **榜样力量**：被他人点赞或认可3次

### 徽章UI展示设计

**成就展示墙：**

- 网格化布局，自动解锁
- 新获得徽章突出显示（"新！"提示）
- 进度百分比显示（"20/50徽章已收集"）
- 徽章详情弹窗
  - 点击徽章看到获得时间、完成条件
  - "如何获得"提示，引导继续努力
  - 未解锁徽章灰色显示

**成长仪表板：**

- 徽章成就时间轴：横向滚动，展示成长轨迹
- 连续打卡日历视图：热力图显示坚持天数
- 习惯养成雷达图：展示阅读、运动、家务、学习的均衡发展

### 游戏化与平衡策略

**避免过度游戏化的关键原则：**

1. **内在动机培养**：徽章成就不只是为了炫耀，更是为了让孩子看到自己的全面成长
2. **多元评价**：不只看积分，更看重行为品质（诚实守信、情绪稳定、积极向上）
3. **长期激励**：30天连续打卡比一次性奖励更能培养习惯
4. **社交适度**：排行榜强调个人进步而非横向攀比

---

## Technical Requirements

### TR-1: 前端架构

**需求描述**：PWA Web App（主端）+ Mini-program（辅助端），支持离线和推送。

### TR-2: 后端架构

**需求描述**：Next.js 16.1.4 + better-auth + 手机号认证 + rate limit。

### TR-3: 数据库架构

**需求描述**：SQLite（bun:sqlite）作为主存储，Redis缓存任务列表、积分状态、会话数据。

### TR-4: 状态管理

**需求描述**：Zustand。

### TR-5: 设备共享

**需求描述**：支持共享设备，4-6位PIN码登录，操作完毕后2分钟自动锁定。

---

## Acceptance Criteria

### AC-1: 家长可以通过任务模板快速设置5-10个日常任务

### AC-3: 孩子完成任务后立即看到星星增加，有即时反馈

### AC-4: 家长可以查看孩子的行为历史和积分变化记录

### AC-5: 孩子可以创建愿望清单，包括物品和互动体验

### AC-6: 系统支持多孩管理，数据完全隔离

### AC-7: 支持连续打卡combo机制，有视觉和音效反馈

### AC-9: 支持15岁青少年的隐私保护和自主权管理

### AC-10: 系统通过年龄验证和家长同意机制，符合COPPA/GDPR/中国儿童个人信息网络保护规定的合规要求

---

_PRD文档已包含完整的产品愿景和徽章成就体系，等待用户确认和后续细化_
